DROP TABLE IF EXISTS `t_ord`;
CREATE TABLE `t_ord` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `nname` varchar(50) NOT NULL,
  `oorder` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

INSERT INTO `t_ord` (`id`, `nname`, `oorder`) VALUES
(1,	'A',	1),
(2,	'B',	2),
(3,	'C',	3),
(4,	'D',	4),
(5,	'E',	5),
(6,	'F',	6),
(7,	'G',	7);



update t_ord set oorder=oorder+1 where oorder between 2 and (select oorder from (select oorder from t_ord where id=4) o)


update t_ord t cross join (select SIGN(oorder-2) as r2,oorder as o2 from t_ord where id=4) t2
set oorder = oorder + t2.r2
where oorder between 2 and t2.o2


select * from t_ord t cross join (
select 
 oorder as o2, @rn := 4, @ri := 4
,SIGN(oorder-@rn) as r2
,case when oorder>@rn then @rn else oorder end as b1
,case when @rn<oorder then oorder else @rn end as b2
from t_ord where id=@ri) t2

--2->4
update t_ord t cross join (
select 
 oorder as o2, @rn := 4
,SIGN(oorder-@rn) as r2
,case when oorder>@rn then @rn else oorder end as b1
,case when @rn<oorder then oorder else @rn end as b2
from t_ord where id=2) t2
set oorder = oorder + t2.r2
where oorder between t2.b1 and t2.b2
;update t_ord set oorder=4 where id=2
;select * from t_ord

--7->3
update t_ord t cross join (
select 
 oorder as o2, @rn := 3
,SIGN(oorder-@rn) as r2
,case when oorder>@rn then @rn else oorder end as b1
,case when @rn<oorder then oorder else @rn end as b2
from t_ord where id=7) t2
set oorder = oorder + t2.r2
where oorder between t2.b1 and t2.b2
;update t_ord set oorder=3 where id=7
;select * from t_ord


select * from t_ord t cross join (select oorder as o2 from t_ord where id=4) t2
where oorder between 2 and t2.o2

-- reset
update t_ord set oorder=id;
select * from t_ord


select